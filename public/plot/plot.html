<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://www.desmos.com/api/v1.6/calculator.js?apiKey=dcb31709b452b1cf9dc26972add0fda6"></script>
</head>
<body>
<div id="calculator" style="width: 600px; height: 400px;"></div>

<script>
    const elt = document.getElementById('calculator')
    const calculator = Desmos.GraphingCalculator(elt, {expressionsCollapsed: true})
    let mathFunction = {id: "function", latex: ""}
    let p1 = {id: "p1", latex: "", color: ""}
    let p2 = {id: "p2", latex: "", color: ""}
    let p3 = {id: "p3", latex: "", color: ""}

    const receiveDataFromWeb =  (message) => {

        if (message.data.mathFunction !== undefined) {
            mathFunction.latex = message.data.mathFunction
        }
        calculator.setExpression(mathFunction)

        if (message.data.p1 === undefined) {
            calculator.removeExpression(p1)
        } else {
            p1.latex = `(${message.data.p1.x.toFixed(10)},0)`
            p1.color = getColor(message.data.p1.fx)
            calculator.setExpression(p1)
        }

        if (message.data.p2 === undefined) {
            calculator.removeExpression(p2)
        } else {
            p2.latex = `(${message.data.p2.x.toFixed(10)},0)`
            p2.color = getColor(message.data.p2.fx)
            calculator.setExpression(p2);
        }

        if (message.data.p3 === undefined) {
            calculator.removeExpression(p3)
        } else {
            p3.latex = `(${message.data.p3.x.toFixed(10)},0)`
            p3.color = getColor(message.data.p3.fx)
            calculator.setExpression(p3);
        }
    }

    const getColor = function (value) {
        if (value > 0)
            return "#c74440"

        if (value < 0)
            return "#2d70b3"

        return "#388c46"
    }

    window.addEventListener("message", receiveDataFromWeb);


</script>
</body>
</html>